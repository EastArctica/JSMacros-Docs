{
  "name": "VillagerEntityHelper",
  "fullClassName": "xyz.wagyourtail.jsmacros.client.api.helpers.world.entity.VillagerEntityHelper",
  "extends": "MerchantEntityHelper<VillagerEntity>",
  "since": "JsMacros 1.6.3",
  "description": "The VillagerEntityHelper class provides specialized access to villager entities in Minecraft, offering methods to interact with villager-specific properties such as profession, level, and style.",
  "overview": "This class extends MerchantEntityHelper and inherits all trading functionality including trade offers, merchant experience, and customer status.\n\nThis helper is particularly useful for creating scripts that:\n- Analyze villager professions and trading capabilities\n- Monitor villager levels and experience\n- Create automated trading systems based on profession\n- Track village economics and specialized trades\n- Find specific types of villagers for particular trades",
  "constructors": [],
  "methods": [
    {
      "name": "getProfession",
      "signature": "getProfession()",
      "returnType": "String",
      "description": "Retrieves the profession identifier of the villager (e.g., 'minecraft:farmer', 'minecraft:nitwit').",
      "parameters": [],
      "static": false,
      "examples": [
        "// Example: Getting VillagerEntityHelper from nearby villagers\nconst player = Player.getPlayer();\nconst nearbyEntities = World.getEntities(10); // 10 block radius\nlet villagers = [];\n\nfor (const entity of nearbyEntities) {\n    if (entity.is(\"minecraft:villager\")) {\n        villagers.push(entity.asVillager());\n    }\n}\n\nChat.log(`Found ${villagers.length} villagers nearby`);\nvillagers.forEach(villager => {\n    Chat.log(`- ${villager.getProfession()} Level ${villager.getLevel()} ${villager.getStyle()}`);\n});",
        "function createVillageEconomyManager() {\n    const economyData = {\n        professions: new Map(),\n        totalTrades: 0,\n        lastUpdate: 0\n    };\n\n    function analyzeVillageEconomy() {\n        const entities = World.getEntities(40);\n        const villagers = [];\n\n        for (const entity of entities) {\n            if (entity.is(\"minecraft:villager\")) {\n                villagers.push({\n                    villager: entity.asVillager(),\n                    entity: entity,\n                    position: entity.getPos()\n                });\n            }\n        }\n\n        if (villagers.length === 0) {\n            Chat.log(\"No villagers found for economy analysis\");\n            return;\n        }\n\n        // Reset economy data\n        economyData.professions.clear();\n        let totalExperience = 0;\n        let totalValueScore = 0;\n\n        villagers.forEach(data => {\n            const villager = data.villager;\n            const profession = villager.getProfession();\n            const level = villager.getLevel();\n            const trades = villager.getTrades();\n            const experience = villager.getExperience();\n\n            totalExperience += experience;\n\n            // Calculate trade value score\n            let valueScore = 0;\n            trades.forEach(trade => {\n                if (trade.isAvailable()) {\n                    const inputs = trade.getInput();\n                    const output = trade.getOutput();\n\n                    // Simple value calculation\n                    const inputValue = inputs.reduce((sum, item) => sum + item.getCount(), 0);\n                    const outputValue = output.getCount();\n                    valueScore += outputValue / Math.max(1, inputValue);\n                }\n            });\n\n            totalValueScore += valueScore;\n\n            // Store profession data\n            if (!economyData.professions.has(profession)) {\n                economyData.professions.set(profession, {\n                    count: 0,\n                    totalLevel: 0,\n                    totalExperience: 0,\n                    totalValueScore: 0,\n                    totalTrades: 0,\n                    availableTrades: 0\n                });\n            }\n\n            const professionData = economyData.professions.get(profession);\n            professionData.count++;\n            professionData.totalLevel += level;\n            professionData.totalExperience += experience;\n            professionData.totalValueScore += valueScore;\n            professionData.totalTrades += trades.length;\n            professionData.availableTrades += trades.filter(t => t.isAvailable()).length;\n        });\n\n        economyData.totalTrades = Array.from(economyData.professions.values())\n            .reduce((sum, data) => sum + data.totalTrades, 0);\n        economyData.lastUpdate = Date.now();\n\n        // Display economy report\n        displayEconomyReport(villagers.length, totalExperience, totalValueScore);\n    }\n\n    function displayEconomyReport(totalVillagers, totalExperience, totalValueScore) {\n        Chat.log(\"=== Village Economy Report ===\");\n        Chat.log(`Villagers: ${totalVillagers}`);\n        Chat.log(`Total Experience: ${totalExperience}`);\n        Chat.log(`Economy Strength: ${totalValueScore.toFixed(1)}`);\n\n        Chat.log(\"\\n=== Profession Analysis ===\");\n\n        const sortedProfessions = Array.from(economyData.professions.entries())\n            .sort((a, b) => b[1].totalValueScore - a[1].totalValueScore);\n\n        sortedProfessions.forEach(([profession, data]) => {\n            const professionName = profession.split(':')[1] || profession;\n            const avgLevel = (data.totalLevel / data.count).toFixed(1);\n            const avgExperience = (data.totalExperience / data.count).toFixed(0);\n            const tradeEfficiency = ((data.availableTrades / data.totalTrades) * 100).toFixed(1);\n\n            Chat.log(`\\n${professionName.toUpperCase()}:`);\n            Chat.log(`  Count: ${data.count}`);\n            Chat.log(`  Average Level: ${avgLevel}`);\n            Chat.log(`  Average Experience: ${avgExperience}`);\n            Chat.log(`  Trade Efficiency: ${tradeEfficiency}% (${data.availableTrades}/${data.totalTrades} available)`);\n            Chat.log(`  Economic Value: ${data.totalValueScore.toFixed(1)}`);\n        });\n\n        // Economy recommendations\n        Chat.log(\"\\n=== Economy Recommendations ===\");\n\n        // Find missing important professions\n        const importantProfessions = [\n            \"minecraft:farmer\", \"minecraft:librarian\", \"minecraft:cleric\",\n            \"minecraft:armorer\", \"minecraft:tool_smith\", \"minecraft:weapon_smith\"\n        ];\n\n        const missingProfessions = importantProfessions.filter(p =>\n            !economyData.professions.has(p)\n        );\n\n        if (missingProfessions.length > 0) {\n            Chat.log(\"⚠ Missing important professions:\");\n            missingProfessions.forEach(p => {\n                const name = p.split(':')[1];\n                Chat.log(`  - ${name}`);\n            });\n        }\n\n        // Check for low efficiency\n        const lowEfficiencyProfessions = Array.from(economyData.professions.entries())\n            .filter(([name, data]) => (data.availableTrades / data.totalTrades) < 0.5)\n            .map(([name, data]) => name.split(':')[1]);\n\n        if (lowEfficiencyProfessions.length > 0) {\n            Chat.log(\"⚠ Low trade efficiency detected:\");\n            lowEfficiencyProfessions.forEach(name => {\n                Chat.log(`  - ${name} (may need restocking)`);\n            });\n        }\n\n        // Overall economy health\n        const avgValuePerVillager = totalValueScore / totalVillagers;\n        if (avgValuePerVillager > 5) {\n            Chat.log(\"✓ Strong economy with excellent trading opportunities\");\n        } else if (avgValuePerVillager > 3) {\n            Chat.log(\"○ Moderate economy with decent trading opportunities\");\n        } else {\n            Chat.log(\"✗ Weak economy - consider improving trades and villager levels\");\n        }\n    }\n\n    // Run analysis on command\n   JsMacros.on(\"Tick\", JavaWrapper.methodToJavaAsync((event) => {\n        // Check for key press to trigger analysis (example: F6 key)\n        const player = Player.getPlayer();\n        if (player && player.getKeybinding(\"key.debug\").isPressed()) {\n            analyzeVillageEconomy();\n        }\n    }));\n\n    Chat.log(\"Village Economy Manager activated!\");\n    Chat.log(\"Press F6 (debug key) to analyze village economy\");\n}\n\n// Start the economy manager\ncreateVillageEconomyManager();"
      ]
    },
    {
      "name": "getStyle",
      "signature": "getStyle()",
      "returnType": "String",
      "description": "Retrieves the biome style variant of the villager (e.g., 'minecraft:plains', 'minecraft:desert').",
      "parameters": [],
      "static": false,
      "examples": [
        "function scanVillage() {\n    const entities = World.getEntities(50); // 50 block radius\n    const villagers = [];\n    const golems = [];\n\n    // Find all villagers and iron golems\n    for (const entity of entities) {\n        if (entity.is(\"minecraft:villager\")) {\n            villagers.push(entity.asVillager());\n        } else if (entity.is(\"minecraft:iron_golem\")) {\n            golems.push(entity);\n        }\n    }\n\n    Chat.log(\"=== Village Analysis ===\");\n    Chat.log(`Villagers: ${villagers.length}`);\n    Chat.log(`Iron Golems: ${golems.length}`);\n\n    if (villagers.length === 0) {\n        Chat.log(\"No villagers found. This might not be a village.\");\n        return;\n    }\n\n    // Analyze villager population\n    const professionStats = new Map();\n    const levelStats = new Map();\n    const styleStats = new Map();\n\n    let totalExperience = 0;\n    let unemployedCount = 0;\n\n    villagers.forEach(villager => {\n        const profession = villager.getProfession();\n        const level = villager.getLevel();\n        const style = villager.getStyle();\n        const experience = villager.getExperience();\n\n        // Count statistics\n        professionStats.set(profession, (professionStats.get(profession) || 0) + 1);\n        levelStats.set(level, (levelStats.get(level) || 0) + 1);\n        styleStats.set(style, (styleStats.get(style) || 0) + 1);\n\n        totalExperience += experience;\n\n        if (profession === \"minecraft:nitwit\" || profession === \"minecraft:none\") {\n            unemployedCount++;\n        }\n    });\n\n    // Display profession breakdown\n    Chat.log(\"\\n=== Professions ===\");\n    for (const [profession, count] of professionStats) {\n        const professionName = profession.split(':')[1] || profession;\n        const percentage = ((count / villagers.length) * 100).toFixed(1);\n        Chat.log(`${professionName}: ${count} (${percentage}%)`);\n    }\n\n    // Display level breakdown\n    Chat.log(\"\\n=== Levels ===\");\n    for (let level = 1; level <= 5; level++) {\n        const count = levelStats.get(level) || 0;\n        const percentage = ((count / villagers.length) * 100).toFixed(1);\n        const levelName = [\"Novice\", \"Apprentice\", \"Journeyman\", \"Expert\", \"Master\"][level - 1];\n        Chat.log(`${levelName} (L${level}): ${count} (${percentage}%)`);\n    }\n\n    // Village health assessment\n    Chat.log(\"\\n=== Village Health ===\");\n    const avgExperience = (totalExperience / villagers.length).toFixed(1);\n    Chat.log(`Average Experience: ${avgExperience}`);\n    Chat.log(`Unemployed: ${unemployedCount}/${villagers.length} (${((unemployedCount / villagers.length) * 100).toFixed(1)}%)`);\n\n    const golemRatio = golems.length / Math.max(1, villagers.length);\n    if (golemRatio >= 0.1) {\n        Chat.log(\"✓ Good iron golem protection\");\n    } else {\n        Chat.log(\"⚠ Low iron golem protection - village may be vulnerable\");\n    }\n\n    // Trading capacity assessment\n    const expertOrMaster = (levelStats.get(4) || 0) + (levelStats.get(5) || 0);\n    if (expertOrMaster >= 3) {\n        Chat.log(\"✓ Excellent trading opportunities available\");\n    } else if (expertOrMaster >= 1) {\n        Chat.log(\"○ Good trading opportunities\");\n    } else {\n        Chat.log(\"✗ Limited high-level traders - consider trading to level up villagers\");\n    }\n}\n\n// Run the village scanner\nscanVillage();"
      ]
    },
    {
      "name": "getLevel",
      "signature": "getLevel()",
      "returnType": "int",
      "description": "Retrieves the current trading level of the villager (1-5).",
      "parameters": [],
      "static": false,
      "examples": [
        "function createTradingAssistant() {\n    let lastScanTime = 0;\n    const SCAN_COOLDOWN = 5000; // 5 seconds between scans\n\n    function scanNearbyVillagers() {\n        const currentTime = Date.now();\n        if (currentTime - lastScanTime < SCAN_COOLDOWN) {\n            return; // Too soon to scan again\n        }\n        lastScanTime = currentTime;\n\n        const player = Player.getPlayer();\n        if (!player) return;\n\n        const entities = World.getEntities(15); // 15 block radius\n        const nearbyVillagers = [];\n\n        for (const entity of entities) {\n            if (entity.is(\"minecraft:villager\")) {\n                const distance = player.distanceTo(entity);\n                if (distance <= 10) { // Only very close villagers\n                    nearbyVillagers.push({\n                        villager: entity.asVillager(),\n                        entity: entity,\n                        distance: distance\n                    });\n                }\n            }\n        }\n\n        if (nearbyVillagers.length > 0) {\n            Chat.log(`&6=== ${nearbyVillagers.length} Villagers Nearby ===`);\n\n            nearbyVillagers.forEach((data, index) => {\n                const villager = data.villager;\n                const profession = villager.getProfession().split(':')[1] || \"unknown\";\n                const level = villager.getLevel();\n                const trades = villager.getTrades();\n                const availableTrades = trades.filter(t => t.isAvailable()).length;\n\n                Chat.log(`${index + 1}. &aLevel ${level} ${profession}&r (${data.distance.toFixed(1)}m)`);\n                Chat.log(`   Available trades: ${availableTrades}/${trades.length}`);\n\n                // Show trade status with color coding\n                if (availableTrades === 0) {\n                    Chat.log(`   &cNo available trades - restock needed`);\n                } else if (availableTrades < trades.length / 2) {\n                    Chat.log(`   &eSome trades available`);\n                } else {\n                    Chat.log(`   &aMany trades available`);\n                }\n\n                // Check if villager is busy\n                if (villager.hasCustomer()) {\n                    Chat.log(`   ⚠ Currently trading with someone`);\n                }\n            });\n        }\n    }\n\n    // Auto-trigger scan when player is near villagers\n   JsMacros.on(\"Tick\", JavaWrapper.methodToJavaAsync(() => {\n        const player = Player.getPlayer();\n        if (!player) return;\n\n        const entities = World.getEntities(8); // 8 block radius for detection\n        let hasVillagerNearby = false;\n\n        for (const entity of entities) {\n            if (entity.is(\"minecraft:villager\")) {\n                hasVillagerNearby = true;\n                break;\n            }\n        }\n\n        if (hasVillagerNearby) {\n            scanNearbyVillagers();\n        }\n    }));\n\n    Chat.log(\"Trading assistant activated! Will scan when villagers are nearby.\");\n}\n\n// Start the trading assistant\ncreateTradingAssistant();",
        "function createVillagerFinder() {\n    const professionInfo = {\n        \"minecraft:farmer\": {\n            name: \"Farmer\",\n            trades: [\"crops\", \"seeds\", \"food\", \"cakes\", \"cookies\"],\n            searchItems: [\"wheat\", \"carrot\", \"potato\", \"beetroot\"],\n            description: \"Sells food ingredients and buys crops\"\n        },\n        \"minecraft:librarian\": {\n            name: \"Librarian\",\n            trades: [\"books\", \"enchanted books\", \"bookshelves\", \"lanterns\"],\n            searchItems: [\"bookshelf\", \"enchanted_book\"],\n            description: \"Sells enchanted books and book-related items\"\n        },\n        \"minecraft:cleric\": {\n            name: \"Cleric\",\n            trades: [\"ender pearls\", \"redstone\", \"bottles o' enchanting\", \"ghast tears\"],\n            searchItems: [\"ender_pearl\", \"redstone\", \"experience_bottle\"],\n            description: \"Sells magical and rare items\"\n        },\n        \"minecraft:armorer\": {\n            name: \"Armorer\",\n            trades: [\"armor\", \"chainmail\", \"bells\", \"shields\"],\n            searchItems: [\"iron_chestplate\", \"bell\"],\n            description: \"Sells armor and protective equipment\"\n        },\n        \"minecraft:weapon_smith\": {\n            name: \"Weapon Smith\",\n            trades: [\"weapons\", \"axes\", \"swords\", \"crossbows\"],\n            searchItems: [\"iron_sword\", \"crossbow\"],\n            description: \"Sells weapons and combat tools\"\n        },\n        \"minecraft:tool_smith\": {\n            name: \"Tool Smith\",\n            trades: [\"tools\", \"pickaxes\", \"axes\", \"shovels\", \"hoes\"],\n            searchItems: [\"iron_pickaxe\", \"stone_tools\"],\n            description: \"Sells tools and utility items\"\n        }\n    };\n\n    function findVillagersByWantedItems() {\n        const entities = World.getEntities(30);\n        const villagers = [];\n\n        for (const entity of entities) {\n            if (entity.is(\"minecraft:villager\")) {\n                villagers.push({\n                    villager: entity.asVillager(),\n                    entity: entity,\n                    position: entity.getPos()\n                });\n            }\n        }\n\n        if (villagers.length === 0) {\n            Chat.log(\"No villagers found nearby\");\n            return;\n        }\n\n        Chat.log(\"=== Villager Trading Directory ===\");\n        Chat.log(`Found ${villagers.length} villagers in range\\n`);\n\n        // Group by profession\n        const byProfession = new Map();\n\n        villagers.forEach(data => {\n            const villager = data.villager;\n            const profession = villager.getProfession();\n\n            if (!byProfession.has(profession)) {\n                byProfession.set(profession, []);\n            }\n            byProfession.get(profession).push(data);\n        });\n\n        // Display organized by profession\n        byProfession.forEach((villagers, profession) => {\n            const info = professionInfo[profession];\n            if (info) {\n                Chat.log(`&6${info.name} (${villagers.length} found):&r`);\n                Chat.log(`  ${info.description}`);\n\n                villagers.forEach((data, index) => {\n                    const villager = data.villager;\n                    const level = villager.getLevel();\n                    const trades = villager.getTrades();\n                    const availableTrades = trades.filter(t => t.isAvailable()).length;\n\n                    const distance = Player.getPlayer() ?\n                        Player.getPlayer().distanceTo(data.entity).toFixed(1) : \"unknown\";\n\n                    Chat.log(`  ${index + 1}. Level ${level} - ${distance}m away`);\n                    Chat.log(`     Available trades: ${availableTrades}/${trades.length}`);\n\n                    // Highlight if master level or many available trades\n                    if (level === 5) {\n                        Chat.log(`     &a✓ Master trader - best prices!`);\n                    } else if (availableTrades >= trades.length * 0.8) {\n                        Chat.log(`     &a✓ Many trades available`);\n                    }\n                });\n                Chat.log(\"\");\n            }\n        });\n\n        // Find trading opportunities based on what player has\n        findTradingOpportunities(villagers);\n    }\n\n    function findTradingOpportunities(villagers) {\n        const player = Player.getPlayer();\n        if (!player) return;\n\n        const playerInventory = player.getInventory();\n        const playerItems = new Set();\n\n        // Check what items player has in hotbar and main inventory\n        for (let i = 0; i < Math.min(36, playerInventory.getSlotCount()); i++) {\n            const stack = playerInventory.getSlot(i);\n            if (!stack.isEmpty()) {\n                playerItems.add(stack.getName().toLowerCase().replace(/[^a-z_]/g, '_'));\n            }\n        }\n\n        Chat.log(\"&6=== Trading Opportunities ===&r\");\n\n        let foundOpportunities = false;\n\n        villagers.forEach(data => {\n            const villager = data.villager;\n            const profession = villager.getProfession();\n            const info = professionInfo[profession];\n\n            if (info) {\n                // Check if player has items this profession might want\n                const hasWantedItems = info.searchItems.some(item =>\n                    playerItems.has(item)\n                );\n\n                if (hasWantedItems) {\n                    foundOpportunities = true;\n                    const level = villager.getLevel();\n                    const trades = villager.getTrades().filter(t => t.isAvailable()).length;\n\n                    Chat.log(`&a${info.name}&r (Level ${level}) - ${trades} trades available`);\n                    Chat.log(`  Wants: ${info.searchItems.filter(item => playerItems.has(item)).join(\", \")}`);\n                }\n            }\n        });\n\n        if (!foundOpportunities) {\n            Chat.log(\"No immediate trading opportunities found with current inventory\");\n            Chat.log(\"Try gathering: emeralds, crops, iron, paper, or other common trade items\");\n        }\n    }\n\n    // Command to run the finder\n   JsMacros.on(\"Tick\", JavaWrapper.methodToJavaAsync((event) => {\n        const player = Player.getPlayer();\n        if (player && player.getKeybinding(\"key.debug\").isPressed()) {\n            findVillagersByWantedItems();\n        }\n    }));\n\n    Chat.log(\"Villager Finder activated!\");\n    Chat.log(\"Press F6 (debug key) to scan for villagers and trading opportunities\");\n}\n\n// Start the villager finder\ncreateVillagerFinder();"
      ]
    }
  ]
}